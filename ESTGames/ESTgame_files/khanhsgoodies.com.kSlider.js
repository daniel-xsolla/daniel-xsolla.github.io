/**********************************
Khanhsgoodies.com
Title: kSlider
Author: Khanh Vu
Date: 5-17-15
***********************************/


var kSlider=function(t){this.init(t)};kSlider.prototype={curSlide:0,offset:0,totalSet:0,totalCloneStart:0,totalCloneEnd:0,isPending:!1,init:function(t){var e=this;$(function(){e.setting=$.extend({elemContainer:".kSlider",elemNext:".kSlider_next",elemPrevious:".kSlider_previous",elemPreloader:".kSlider_preloader",totalClone:1,isLoop:!1,heightBase:"parent",type:"fade",width:1280,height:720,onLoad:function(){},onBefore:function(){},onAfter:function(){},onDestroy:function(){},setSizeInner:!0,innerMode:"cover",autoplay:!0,delay:8e3,speed:1e3},t),e.c=$(e.setting.elemContainer),e.i=e.c.find(".slide"),e.btn_next=$(e.setting.elemNext),e.btn_previous=$(e.setting.elemPrevious),e.totalSet=e.i.length,e.isLoop=e.setting.isLoop,e.heightBase=e.setting.heightBase,e.type=e.setting.type,e.totalCloneStart=e.setting.totalClone,e.totalCloneEnd=e.setting.totalClone,e.totalCloneStart>e.totalSet&&(e.totalCloneStart=e.totalSet),e.totalCloneEnd>e.totalSet&&(e.totalCloneEnd=e.totalSet),("fade"==e.type||1==e.totalSet)&&(e.totalCloneStart=e.totalCloneEnd=0),e.curSlide=e.totalCloneStart,e.build(),e.setSize(),e.setEvent(),e.setting.onLoad(),e.play(null,null,!0)})},build:function(){var t=this;t.c.css({position:"absolute",top:0,left:0}),t.i.css({position:"absolute",top:0,left:0}),"child"==t.setting.heightBase&&t.c.css({position:"relative",top:0,left:0}),t.i.each(function(t,e){$(e).attr("data-idx",t)});var e,i=[],o=[];for(e=0;e<t.totalCloneStart;e++)i.push(t.i.eq(t.totalSet-1-e).clone(!0,!0).addClass("slide_clone"));for(e=0;e<t.totalCloneEnd;e++)o.push(t.i.eq(e).clone(!0,!0).addClass("slide_clone"));$.each(i,function(e,i){i.prependTo(t.c)}),$.each(o,function(e,i){i.appendTo(t.c)}),t.i=t.c.find(".slide"),$(t.setting.elemPreloader).hide()},setSize:function(){var t=this;t.totalSet=t.i.length,"parent"==t.heightBase?(t.width=t.c.parent().width(),t.height=t.c.parent().height()):"child"==t.heightBase&&(t.ratioW=t.setting.width/t.setting.height,t.ratioH=t.setting.height/t.setting.width,t.width=t.c.parent().width(),t.height=t.width*t.ratioH),t.c.width(t.width).height(t.height),t.i.width(t.width).height(t.height),t.setting.setSizeInner&&t.miscSetSizeInner(),t.play(null,null,!0)},preload:function(t,e){var i=this;$(i.setting.elemPreloader).show();try{var o=$("html").is(".ie6, .ie7, .ie8")?"?"+(new Date).getTime():"";$(new Image).attr("src",""+t+o).load(function(){$(i.setting.elemPreloader).hide(),e(t+o)})}catch(n){$(i.setting.elemPreloader).hide(),e(t)}},play:function(t,e,i){var o=this;if(t!=o.curSlide&&!o.isPending){o.isPending=!0,(t||0==t)&&(o.curSlide=t),o.offset=o.curSlide*o.width;var n=i?1:o.setting.speed,a=function(){o.setting.onBefore(o.curSlide),"slide"==o.type?o.i.each("end-to-start"==e?function(t,e){$(e).stop().animate({left:t*o.width-o.offset,top:0},n,function(){t==o.totalSet-1&&(o.curSlide=o.totalCloneStart,o.offset=o.curSlide*o.width,o.i.each(function(t,e){$(e).stop().css({left:t*o.width-o.offset,top:0})}),o.onAfter(o.getCurrentSlide()),o.isPending=!1)})}:"start-to-end"==e?function(t,e){$(e).stop().animate({left:t*o.width-o.offset,top:0},n,function(){t==o.totalSet-1&&(o.curSlide=o.totalSet-1-o.totalCloneEnd,o.offset=o.curSlide*o.width,o.i.each(function(t,e){$(e).stop().css({left:t*o.width-o.offset,top:0})}),o.onAfter(o.getCurrentSlide()),o.isPending=!1)})}:function(t,e){$(e).stop().animate({left:t*o.width-o.offset,top:0},n,function(){t==o.totalSet-1&&(o.onAfter(o.getCurrentSlide()),o.isPending=!1)})}):o.i.stop().animate({opacity:0}).css("z-index",1).eq(o.curSlide).stop().css("z-index",2).animate({opacity:1},n,function(){o.onAfter(o.getCurrentSlide()),o.isPending=!1})},l=0==o.i.eq(o.curSlide).children("img").length?"html":"img";"img"==l?1==o.i.eq(o.curSlide).children("img").data("img-loaded")||null==o.i.eq(o.curSlide).children("img").attr("data-src")||void 0===o.i.eq(o.curSlide).children("img").attr("data-src")?a():o.preload(o.i.eq(o.curSlide).children("img").attr("data-src"),function(t){o.i.eq(o.curSlide).children("img").attr("src",t).data("img-loaded",!0),a()}):a()}},next:function(){var t=this;t.isPending||(t.curSlide<t.totalSet-1-t.totalCloneEnd?(t.curSlide++,t.play()):t.curSlide<t.totalSet-1?(t.curSlide++,t.play(null,"end-to-start")):t.isLoop&&(t.curSlide=0,t.play()))},previous:function(){var t=this;t.isPending||(t.curSlide>0+t.totalCloneStart?(t.curSlide--,t.play()):t.curSlide>0?(t.curSlide--,t.play(null,"start-to-end")):t.isLoop&&(t.curSlide=t.totalSet-1,t.play()))},setEvent:function(){var t=this;t.eNext=function(){t.next()},t.ePrevious=function(){t.previous()},t.eWinResize=function(){t.setSize()},t.eClick=function(){0!=t.totalCloneStart&&($(this).index()>t.curSlide?t.next():$(this).index()<t.curSlide&&t.previous())},t.btn_next.bind("click",t.eNext),t.btn_previous.bind("click",t.ePrevious),$(window).bind("resize",t.eWinResize),t.i.bind("click",t.eClick),t.i.children("img").bind("load",t.eWinResize)},onAfter:function(t){var e=this;try{e.setting.onAfter(t),clearTimeout(e.iAutoplay),e.setting.autoplay&&(e.isLoop=!0,e.iAutoplay=setTimeout(function(){e.next()},e.setting.delay))}catch(i){}},destroy:function(){var t=this;t.btn_next.unbind("click",t.eNext),t.btn_previous.unbind("click",t.ePrevious),$(window).unbind("resize",t.eWinResize),t.i.removeAttr("data-idx"),t.c.find(".slide_clone").remove(),clearTimeout(t.iAutoplay),t.onAfter=function(){},t.setting.onDestroy()},getCurrentSlide:function(){var t=this;return t.curSlide-t.totalCloneStart},miscSetSizeInner:function(){var t=this;t.i.each(function(e,i){var o,n=0==$(i).children("img").length?"html":"img";if("img"==n){var a=$(i).children("img"),l=kSlider.getImage(a);if("contain"==a.attr("data-mode")||"contain"==t.setting.innerMode)o=kSlider.getImageSizeContain({width:$(i).width(),height:$(i).height()},{width:l.width,height:l.height}),a.width(o.width).height(o.height).css({top:o.top,left:o.left});else if("cover"==a.attr("data-mode")||"cover"==t.setting.innerMode){o=kSlider.getImageSizeCover({width:$(i).width(),height:$(i).height()},{width:l.width,height:l.height}),a.width(o.width).height(o.height).css("position","absolute");var r=o.left,s=o.top;if(""==a.attr("background-direction"))a.css({top:s,left:r});else{var d=a.attr("background-direction");null==d&&(d="center,0");var h=d.split(",")[0],c=d.split(",")[1],u=Math.abs(r),g=Math.abs(s),f=c?parseFloat(c).toFixed(2):0;switch(h){case"top":a.css({top:g*f*-1,left:r,bottom:"auto",right:"auto"});break;case"top-right":a.css({top:g*f*-1,right:u*f*-1,bottom:"auto",left:"auto"});break;case"right":a.css({top:s,right:u*f*-1,bottom:"auto",left:"auto"});break;case"bottom-right":a.css({bottom:g*f*-1,right:u*f*-1,top:"auto",left:"auto"});break;case"bottom":a.css({bottom:g*f*-1,left:r,top:"auto",right:"auto"});break;case"bottom-left":a.css({bottom:g*f*-1,left:u*f*-1,top:"auto",right:"auto"});break;case"left":a.css({top:s,left:u*f*-1,bottom:"auto",right:"auto"});break;case"top-left":a.css({top:g*f*-1,left:u*f*-1,bottom:"auto",right:"auto"});break;case"center":a.css({top:s,left:r,bottom:"auto",right:"auto"})}}}}else $(i).children("div,span,a").css({width:"100%",height:"100%",position:"absolute",top:0,left:0})})}},kSlider.getImage=function(t){var e=$(t),i=new Image;return i.src=e.attr("src"),{width:i.width,height:i.height,ratioX:i.width/i.height,ratioY:i.height/i.width,src:i.src}},kSlider.getImageSizeCover=function(t,e){var i=e.width/e.height,o=e.height/e.width,n=0,a=0,l=t.width,r=t.height,s=r,d=r*i;return l>d&&(d=l,s=l*o),a=-1*(d-l)/2,n=-1*(s-r)/2,{width:d,height:s,top:n,left:a}},kSlider.getImageSizeContain=function(t,e){var i=e.width/e.height,o=e.height/e.width,n=t.width,a=t.height,l=0,r=0,s=0,d=0,h=function(){d=n,s=n*o,l=(a-s)/2,r=0},c=function(){s=a,d=a*i,l=0,r=(n-d)/2},u=i>=1?"landscape":"portrait";return"landscape"==u?(h(),s>a&&c()):"portrait"==u&&(c(),d>n&&h()),{width:d,height:s,top:l,left:r}};